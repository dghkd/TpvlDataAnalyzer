<UserControl x:Class="TpvlDataAnalyzer.View.PlayerInfoItem"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:convert="clr-namespace:TpvlDataAnalyzer.View.Converter"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:TpvlDataAnalyzer.View"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:model="clr-namespace:TpvlDataAnalyzer.Model"
             xmlns:vm="clr-namespace:TpvlDataAnalyzer.ViewModel"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance vm:PlayerInfoVM,
                                              IsDesignTimeCreatable=True}"
             d:DesignHeight="180"
             d:DesignWidth="650"
             Background="White">
    <UserControl.Resources>
        <Style x:Key="TitleTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>
        <Style x:Key="DescTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Width" Value="110" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>
        <Style TargetType="Border">
            <Setter Property="BorderBrush" Value="Black" />
            <Setter Property="BorderThickness" Value="1,1,0,0" />
        </Style>

        <convert:SortCriterionToBrushConverter x:Key="SortCriterionToBrushConverter" />
        <convert:SortCriterionToBrushMultiConverter x:Key="SortCriterionToBrushMultiConverter" />

        <Style x:Key="SortCriterionRunStyle" TargetType="Run">
            <Setter Property="Foreground">
                <Setter.Value>
                    <MultiBinding Converter="{StaticResource SortCriterionToBrushMultiConverter}">
                        <!--  ViewModel's SortCriterion  -->
                        <Binding Path="DataContext.SortCriterion" RelativeSource="{RelativeSource AncestorType=TextBlock}" />
                        <!--  Run's Tag  -->
                        <Binding Path="Tag" RelativeSource="{RelativeSource Self}" />
                    </MultiBinding>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Foreground" Value="{x:Static Brushes.Red}">
                    <Setter Property="FontWeight" Value="Bold" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SortCriterionTextBlockStyle" TargetType="TextBlock">
            <Setter Property="Foreground">
                <Setter.Value>
                    <MultiBinding Converter="{StaticResource SortCriterionToBrushMultiConverter}">
                        <!--  ViewModel's SortCriterion  -->
                        <Binding Path="SortCriterion" />
                        <!--  Run's Tag  -->
                        <Binding Path="Tag" RelativeSource="{RelativeSource Self}" />
                    </MultiBinding>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Foreground" Value="{x:Static Brushes.Red}">
                    <Setter Property="FontWeight" Value="Bold" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <!--  Root  -->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="150" />
            <ColumnDefinition MaxWidth="60" />
            <ColumnDefinition Width="1*" />
            <ColumnDefinition Width="1*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="1*" />
            <RowDefinition Height="1*" />
            <RowDefinition Height="1*" />
        </Grid.RowDefinitions>

        <!--  Base Info  -->
        <Border Grid.Row="0"
                Grid.RowSpan="3"
                Grid.Column="0"
                BorderThickness="1,1,0,1">
            <StackPanel Margin="5,0"
                        VerticalAlignment="Center"
                        Orientation="Vertical">
                <StackPanel.Resources>
                    <Style BasedOn="{StaticResource SortCriterionTextBlockStyle}" TargetType="TextBlock">
                        <Setter Property="FontSize" Value="16" />
                    </Style>
                </StackPanel.Resources>
                <TextBlock>
                    <Run Text="Rank: " /><Run Text="{Binding SortRank}" />
                </TextBlock>
                <TextBlock FontSize="20" Text="{Binding Name}" />
                <TextBlock VerticalAlignment="Center" Text="{Binding JerseyNumberText}" />
                <TextBlock Text="{Binding PositionText}" />
                <TextBlock Text="{Binding Squad}" />
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="場數: " />
                    <TextBlock Text="{Binding MatchCount}" />
                    <TextBlock Text=" 均: " />
                    <TextBlock Text="{Binding ScoreAvgCountPerMatch, StringFormat={}{0:F2}}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="局數: " />
                    <TextBlock Text="{Binding RoundCount}" />
                    <TextBlock Tag="{x:Static model:PlayerSortCriterion.AvgScorePerRound}" Text=" 均: " />
                    <TextBlock Tag="{x:Static model:PlayerSortCriterion.AvgScorePerRound}" Text="{Binding ScoreAvgCountPerRound, StringFormat={}{0:F2}}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="總得分: " />
                    <TextBlock Text="{Binding ScoreCount}" />
                </StackPanel>
            </StackPanel>
        </Border>

        <!--  Attack  -->
        <Border Grid.Row="0"
                Grid.Column="1"
                Visibility="Collapsed">
            <TextBlock Style="{StaticResource TitleTextStyle}" Text="進攻" />
        </Border>
        <Border Grid.Row="0"
                Grid.Column="1"
                Grid.ColumnSpan="3"
                BorderThickness="1,1,1,0">
            <Border.Resources>
                <Style BasedOn="{StaticResource DescTextStyle}" TargetType="TextBlock" />
                <Style BasedOn="{StaticResource SortCriterionRunStyle}" TargetType="Run" />
            </Border.Resources>
            <StackPanel Margin="5,3"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Orientation="Vertical">
                <!--  Serves  -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Width="32">
                        <Run Text="發球:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.ServesTotal}" Text="{Binding ServesTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.ServesAttemptCount}" Text="{Binding ServesAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.ServesAttemptRate}" Text="{Binding ServesAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.ServesCompleteCount}" Text="{Binding ServesComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.ServesCompleteRate}" Text="{Binding ServesCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.ServesErrorCount}" Text="{Binding ServesError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.ServesErrorRate}" Text="{Binding ServesErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ServesErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>

                <!--  Spikes  -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Width="32">
                        <Run Text="攻擊:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.SpikesTotal}" Text="{Binding SpikesTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.SpikesAttemptCount}" Text="{Binding SpikesAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.SpikesAttemptRate}" Text="{Binding SpikesAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.SpikesCompleteCount}" Text="{Binding SpikesComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.SpikesCompleteRate}" Text="{Binding SpikesCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.SpikesErrorCount}" Text="{Binding SpikesError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.SpikesErrorRate}" Text="{Binding SpikesErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SpikesErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>

                <!--  Sets  -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Width="32">
                        <Run Text="舉球:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.SetsTotal}" Text="{Binding SetsTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.SetsAttemptCount}" Text="{Binding SetsAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.SetsAttemptRate}" Text="{Binding SetsAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.SetsCompleteCount}" Text="{Binding SetsComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.SetsCompleteRate}" Text="{Binding SetsCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.SetsErrorCount}" Text="{Binding SetsError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.SetsErrorRate}" Text="{Binding SetsErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.SetsErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>

                <!--  Attack Contribution  -->
                <StackPanel Orientation="Horizontal" Visibility="Collapsed">
                    <TextBlock Width="32">
                        <Run Text="總和:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.AttackTotal}" Text="{Binding AttackTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.AttackAttemptCount}" Text="{Binding AttackAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.AttackAttemptRate}" Text="{Binding AttackAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.AttackCompleteCount}" Text="{Binding AttackComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.AttackCompleteRate}" Text="{Binding AttackCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.AttackErrorCount}" Text="{Binding AttackError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.AttackErrorRate}" Text="{Binding AttackErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.AttackErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>
            </StackPanel>
        </Border>

        <!--  Defense  -->
        <Border Grid.Row="1"
                Grid.Column="1"
                Visibility="Collapsed">
            <TextBlock Style="{StaticResource TitleTextStyle}" Text="防禦" />
        </Border>
        <Border Grid.Row="1"
                Grid.Column="1"
                Grid.ColumnSpan="3"
                BorderThickness="1,1,1,0">
            <Border.Resources>
                <Style BasedOn="{StaticResource DescTextStyle}" TargetType="TextBlock" />
                <Style BasedOn="{StaticResource SortCriterionRunStyle}" TargetType="Run" />
            </Border.Resources>
            <StackPanel Margin="5,3"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Orientation="Vertical">
                <!--  Blocks  -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Width="32">
                        <Run Text="攔網:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.BlocksTotal}" Text="{Binding BlocksTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.BlocksAttemptCount}" Text="{Binding BlocksAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.BlocksAttemptRate}" Text="{Binding BlocksAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.BlocksCompleteCount}" Text="{Binding BlocksComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.BlocksCompleteRate}" Text="{Binding BlocksCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.BlocksErrorCount}" Text="{Binding BlocksError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.BlocksErrorRate}" Text="{Binding BlocksErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.BlocksErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>

                <!--  Passes  -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Width="32">
                        <Run Text="接發:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.PassesTotal}" Text="{Binding PassesTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.PassesAttemptCount}" Text="{Binding PassesAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.PassesAttemptRate}" Text="{Binding PassesAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.PassesCompleteCount}" Text="{Binding PassesComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.PassesCompleteRate}" Text="{Binding PassesCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.PassesErrorCount}" Text="{Binding PassesError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.PassesErrorRate}" Text="{Binding PassesErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.PassesErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>

                <!--  Defenses  -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Width="32">
                        <Run Text="防守:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.DefensesTotal}" Text="{Binding DefensesTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.DefensesAttemptCount}" Text="{Binding DefensesAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.DefensesAttemptRate}" Text="{Binding DefensesAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.DefensesCompleteCount}" Text="{Binding DefensesComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.DefensesCompleteRate}" Text="{Binding DefensesCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.DefensesErrorCount}" Text="{Binding DefensesError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.DefensesErrorRate}" Text="{Binding DefensesErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.DefensesErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>

                <!--  Resistance Contribution  -->
                <StackPanel Orientation="Horizontal" Visibility="Collapsed">
                    <TextBlock Width="32">
                        <Run Text="總和:" />
                    </TextBlock>
                    <TextBlock Width="50">
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceTotal}" Text="T" /><Run Tag="{x:Static model:PlayerSortCriterion.ResistanceTotal}" Text="{Binding ResistanceTotal}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceAttemptCount}" Text="A" /><Run Tag="{x:Static model:PlayerSortCriterion.ResistanceAttemptCount}" Text="{Binding ResistanceAttempt}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceAttemptRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.ResistanceAttemptRate}" Text="{Binding ResistanceAttemptRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceAttemptRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceCompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.ResistanceCompleteCount}" Text="{Binding ResistanceComplete}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceCompleteRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.ResistanceCompleteRate}" Text="{Binding ResistanceCompleteRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceCompleteRate}" Text="%)" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.ResistanceErrorCount}" Text="{Binding ResistanceError}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceErrorRate}" Text="(" /><Run Tag="{x:Static model:PlayerSortCriterion.ResistanceErrorRate}" Text="{Binding ResistanceErrorRate, StringFormat={}{0:F2}}" />
                        <Run Tag="{x:Static model:PlayerSortCriterion.ResistanceErrorRate}" Text="%)" />
                    </TextBlock>
                </StackPanel>
            </StackPanel>
        </Border>

        <!--  Avg  -->
        <Border Grid.Row="2"
                Grid.Column="1"
                BorderThickness="1,1,0,1">
            <StackPanel VerticalAlignment="Center" Orientation="Vertical">
                <TextBlock Style="{StaticResource TitleTextStyle}" Text="平均" />
                <TextBlock Style="{StaticResource TitleTextStyle}" Text="每局" />
            </StackPanel>
        </Border>
        <Border Grid.Row="2"
                Grid.Column="2"
                BorderThickness="1,1,0,1">
            <Border.Resources>
                <Style BasedOn="{StaticResource DescTextStyle}" TargetType="TextBlock">
                    <Setter Property="Width" Value="Auto" />
                    <Setter Property="MinWidth" Value="80" />
                </Style>
                <Style BasedOn="{StaticResource SortCriterionRunStyle}" TargetType="Run">
                </Style>
            </Border.Resources>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <StackPanel Margin="5,3"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Orientation="Vertical">
                    <TextBlock>
                        <Run Text="發球次:" /><Run Text="{Binding ServesAvgCountPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.AvgSpikesPerRound}" Text="攻擊次:" /><Run Tag="{x:Static model:PlayerSortCriterion.AvgSpikesPerRound}" Text="{Binding SpikesAvgCountPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="舉球次:" /><Run Text="{Binding SetsAvgCountPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                </StackPanel>
                <StackPanel Grid.Column="1"
                            Margin="5,3"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Orientation="Vertical">
                    <TextBlock>
                        <Run Text="攔網次:" /><Run Text="{Binding BlocksAvgCountPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="接發次:" /><Run Text="{Binding PassesAvgCountPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="防守次:" /><Run Text="{Binding DefensesAvgCountPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <!--<TextBlock>
                        <Run Text="S" /><Run Text="{Binding ServesAvgSuccessPerRound, StringFormat={}{0:F2}}" />
                        <Run Text="  " />
                        <Run Text="E" /><Run Text="{Binding ServesAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="S" /><Run Text="{Binding SpikesAvgSuccessPerRound, StringFormat={}{0:F2}}" />
                        <Run Text="  " />
                        <Run Text="E" /><Run Text="{Binding SpikesAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="S" /><Run Text="{Binding SetsAvgSuccessPerRound, StringFormat={}{0:F2}}" />
                        <Run Text="  " />
                        <Run Text="E" /><Run Text="{Binding SetsAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>-->

                    <!--<TextBlock>
                        <Run Text="進攻成功:" /><Run Text="{Binding AttackAvgCompletePerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="進攻失誤:" /><Run Text="{Binding AttackAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>-->
                </StackPanel>
            </Grid>
        </Border>
        <Border Grid.Row="2"
                Grid.Column="3"
                BorderThickness="1">
            <Border.Resources>
                <Style BasedOn="{StaticResource DescTextStyle}" TargetType="TextBlock">
                    <Setter Property="Width" Value="AUto" />
                    <Setter Property="Margin" Value="5,0" />
                </Style>
                <Style BasedOn="{StaticResource SortCriterionRunStyle}" TargetType="Run">
                </Style>
            </Border.Resources>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Border Grid.Row="0"
                        BorderBrush="Black"
                        BorderThickness="0,0,0,1">
                    <TextBlock Width="Auto"
                               MinWidth="0"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Text="總和" />
                </Border>

                <StackPanel Grid.Row="1"
                            Margin="5,3"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.CompleteCount}" Text="S" /><Run Tag="{x:Static model:PlayerSortCriterion.CompleteCount}" Text="{Binding CompleteCount}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Tag="{x:Static model:PlayerSortCriterion.ErrorCount}" Text="E" /><Run Tag="{x:Static model:PlayerSortCriterion.ErrorCount}" Text="{Binding ErrorCount}" />
                    </TextBlock>
                </StackPanel>

                <!--<StackPanel Grid.Column="1"
                            Margin="5,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Orientation="Vertical">
                    <TextBlock>
                        <Run Text="S" /><Run Text="{Binding BlockAvgSuccessPerRound, StringFormat={}{0:F2}}" />
                        <Run Text="  " />
                        <Run Text="E" /><Run Text="{Binding BlocksAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="S" /><Run Text="{Binding PassesAvgSuccessPerRound, StringFormat={}{0:F2}}" />
                        <Run Text="  " />
                        <Run Text="E" /><Run Text="{Binding PassesAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="S" /><Run Text="{Binding DefensesAvgSuccessPerRound, StringFormat={}{0:F2}}" />
                        <Run Text="  " />
                        <Run Text="E" /><Run Text="{Binding DefensesAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>

                    <TextBlock>
                        <Run Text="防禦成功:" /><Run Text="{Binding ResistanceAvgCompletePerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                    <TextBlock>
                        <Run Text="防禦失誤:" /><Run Text="{Binding ResistanceAvgErrorPerRound, StringFormat={}{0:F2}}" />
                    </TextBlock>
                </StackPanel>-->
            </Grid>
        </Border>
    </Grid>
</UserControl>